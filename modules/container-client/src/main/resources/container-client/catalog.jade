extends app-loader-layout

block content
  .root(ng-controller="CatalogRoot")
    .nav-container
      .top-nav-filler

      ul.nav.nav-stacked
        li(ui-sref-active="active")
          a.mainitem-link(ui-sref="item") Item
        li(ui-sref-active="active")
          a.mainitem-link(ui-sref="profile") Profile 
        li(
          ui-sref-active="active",
          ng-repeat="supportingMaterial in item.supportingMaterials")
          a.mainitem-link(ui-sref="supporting-material({index: $index})") {{supportingMaterial.name}}

    .content-container.cc-transition-left-right(ng-class="{'left-nav': !urlParams.hideLeftNav}")
      .top-nav
        button.toggle-left-nav.btn.btn-sm.btn-default(ng-click="toggleLeftNav()")
          i.fa.fa-bars
    
      .main-content(ui-view="main")

    include partials/catalog/item
    include partials/catalog/profile
    include partials/catalog/supporting-material

block app-loader-config
  script.

    var appLoadConfig = {
      moduleName: 'corespring-catalog',
      jsonFile: 'catalog-config.json',
      dependencies: [
        'corespring-common.services',
        'corespring-common.directives',
        'corespring-common.supporting-materials',
        'corespring-player.services',
        'corespring-player.directives',
        'corespring-player.controllers',
        'corespring-catalog.controllers',
        'ui.bootstrap',
        'ui.router'
      ],
      defaultPath: '/item',
      states: {
        item: mkState('item'),
        profile: mkState('profile'),
        'supporting-material' : {
          url: '/supporting-material/:index',
          views: {
            main: {
              templateUrl: '/templates/supporting-material'
            }
          }
        }
      } 
    }

block app-loader-scripts

  script( src="../../components/angular-ui/build/angular-ui.min.js", type="text/javascript")
  script( src="../../components/angular-bootstrap/ui-bootstrap-tpls.js", type="text/javascript")
  script( src="../../components/bootstrap/js/dropdown.js", type="text/javascript")
  script( src="../../components/bootstrap/js/modal.js", type="text/javascript")
  script( src="../../components/bootstrap/js/tooltip.js", type="text/javascript")
  script( src="../../components/bootstrap/js/popover.js", type="text/javascript")
  
  for p in catalog 
    script(src="#{p}", type="text/javascript")

  for p in catalogExtras
    script(src="#{p}", type="text/javascript")
