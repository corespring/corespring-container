@(namespace : String, load : Call, save : Call, componentSet : JsValue)

(function(){
  "use strict";

  angular.module('@namespace', []);

  angular.module('@namespace').factory('EditorServices', ['$http', function($http){

    var def = {
      load: function(onSuccess, onFailure, id){

        var finalUrl = id ? '@load.url'.replace(":id", id) : '@load.url';

        $http['@load.method.toLowerCase'](finalUrl)
          .success(function(data, status, headers, config){
            console.log("[player-services] load item successful");
            onSuccess(data);
          })
          .error(function(data, status, headers, config){
            if(onFailure){
              onFailure(data);
            }
          });
      },
      save: function(item, onSuccess, onFailure, id){
        var finalUrl = id ? '@save.url'.replace(":id", id) : '@save.url';
        $http['@save.method.toLowerCase'](finalUrl, item)
          .success(function(data, status, headers, config) {
            console.log("item saved succesfully")
            onSuccess(data)
          })
          .error(function(data, status, headers, config) {
            console.warn("error");
            if( onFailure ) {
              onFailure(data);
            }
          });
      },
      loadComponents: function(onSuccess, onFailure){
        var components = @{Json.stringify(componentSet)};
        onSuccess(components);
      }
    };
    return def;
  }]);
})();

