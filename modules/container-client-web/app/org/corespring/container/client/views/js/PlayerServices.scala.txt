@(namespace : String, loadSession : Call, submitSession:Call, saveSession: Call, getScore: Call)

angular.module('@namespace', []);

angular.module('@namespace').factory('PlayerServices', ['$http', function($http){

  var callWithData = function(method, url){

    return function(session, onSuccess, onFailure){

      $http[method](url, session)
       .success(
         function(data, status, headers, config) {
           onSuccess(data)
         })
       .error(
         function(data, status, headers, config) {
           console.log("error");
           if( onFailure ) {
            onFailure(data);
           }
         }
       );
    };
 };

var def = {
    submitSession: callWithData('@submitSession.method.toLowerCase', '@submitSession.url'),
    saveSession: callWithData('@saveSession.method.toLowerCase', '@saveSession.url'),
    getScore: callWithData('@getScore.method.toLowerCase', '@getScore.url'),
    loadSession: function(onSuccess, onFailure) {
      $http['@loadSession.method.toLowerCase']('@loadSession.url')
        .success(function(data, status, headers, config){
          console.log("[player-services] load session successful");
          onSuccess(data);
        })
        .error(function(data, status, headers, config){
          if(onFailure){
            onFailure(data);
          }
        })
    }
  }
  return def
}]);

