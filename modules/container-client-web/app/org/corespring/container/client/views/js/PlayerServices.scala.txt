@(namespace : String, loadSession : Call, submitSession:Call, saveSession: Call, getScore: Call, completeResponse:Call)

angular.module('@namespace', []);

angular.module('@namespace').factory('PlayerServices', ['$http', function($http){

  var _call = function(method, url, data){

    return function(onSuccess, onFailure){

      var args = data ? [url, data] : [url];
      $http[method].apply(null, args)
       .success(
         function(data, status, headers, config) {
           onSuccess(data)
         })
       .error(
         function(data, status, headers, config) {
           console.log("error");
           if( onFailure ) {
            onFailure(data);
           }
         }
       );
    };
  };

  var callWithData = function(method, url){
    return function(data, onSuccess, onFailure){
      _call(method, url, data)(onSuccess, onFailure);
    };
 };

 var callWithNoData = function(method, url){
  return function(onSuccess, onFailure){
    _call(method, url, null)(onSuccess, onFailure);
  }
 };

var def = {
    submitSession: callWithData('@submitSession.method.toLowerCase', '@submitSession.url'),
    saveSession: callWithData('@saveSession.method.toLowerCase', '@saveSession.url'),
    getScore: callWithData('@getScore.method.toLowerCase', '@getScore.url'),
    completeResponse: callWithNoData('@completeResponse.method.toLowerCase', '@completeResponse.url'),
    loadSession: callWithNoData('@loadSession.method.toLowerCase', '@loadSession.url')
  }
  return def
}]);

